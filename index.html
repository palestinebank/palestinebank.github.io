<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <title>Ø±ÙØ¹ Ù…Ù„Ù Ø¥Ù„Ù‰ GitHub</title>
  <style>
    body { font-family: Arial; direction: rtl; padding: 20px; max-width: 600px; margin: auto; }
    label { display: block; margin-top: 10px; }
    input, button, select { width: 100%; padding: 8px; margin-top: 5px; }
    #status { margin-top: 15px; font-weight: bold; }
  </style>
</head>
<body>

  <h2>ğŸ”¼ Ø±ÙØ¹ Ù…Ù„Ù Ø¥Ù„Ù‰ GitHub</h2>

  <label>GitHub Username:
    <input type="text" id="username" placeholder="Ù…Ø«Ø§Ù„: salyayed" />
  </label>

  <label>Repository Name:
    <input type="text" id="repo" placeholder="Ù…Ø«Ø§Ù„: pal-map" />
  </label>

  <label>Branch Name:
    <input type="text" id="branch" value="main" />
  </label>

  <label>GitHub Token:
    <input type="password" id="token" placeholder="ØªÙˆÙƒÙ† Ø¨ØµÙ„Ø§Ø­ÙŠØ© repo" />
  </label>

  <label>Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…Ù„Ù Ù„Ø±ÙØ¹Ù‡:
    <input type="file" id="fileInput" />
  </label>

  <button onclick="uploadToGitHub()">ğŸš€ Ø±ÙØ¹ Ø§Ù„Ù…Ù„Ù</button>

  <div id="status"></div>

  <script>
    async function uploadToGitHub() {
      const username = document.getElementById('username').value.trim();
      const repo = document.getElementById('repo').value.trim();
      const branch = document.getElementById('branch').value.trim();
      const token = document.getElementById('token').value.trim();
      const fileInput = document.getElementById('fileInput');
      const status = document.getElementById('status');

      if (!username || !repo || !branch || !token || !fileInput.files.length) {
        alert('ÙŠØ±Ø¬Ù‰ ØªØ¹Ø¨Ø¦Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ ÙˆØ§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…Ù„Ù');
        return;
      }

      const file = fileInput.files[0];
      const fileName = file.name;
      const reader = new FileReader();

      reader.onload = async function () {
        const content = reader.result;
        const base64Content = btoa(content);

        // Ø§Ù„ØªØ­Ù‚Ù‚ Ø¥Ù† ÙƒØ§Ù† Ø§Ù„Ù…Ù„Ù Ù…ÙˆØ¬ÙˆØ¯Ù‹Ø§ Ù…Ø³Ø¨Ù‚Ù‹Ø§ Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ SHA
        let sha = null;
        try {
          const getRes = await fetch(`https://api.github.com/repos/${username}/${repo}/contents/${fileName}`, {
            headers: { Authorization: `token ${token}` }
          });
          if (getRes.ok) {
            const getData = await getRes.json();
            sha = getData.sha;
          }
        } catch (e) {}

        const payload = {
          message: `Upload ${fileName} via browser`,
          content: base64Content,
          branch: branch
        };

        if (sha) payload.sha = sha;

        const url = `https://api.github.com/repos/${username}/${repo}/contents/${fileName}`;

        try {
          const res = await fetch(url, {
            method: 'PUT',
            headers: {
              Authorization: `token ${token}`,
              'Content-Type': 'application/json'
            },
            body: JSON.stringify(payload)
          });

          if (res.ok) {
            status.innerText = `âœ… ØªÙ… Ø±ÙØ¹ Ø§Ù„Ù…Ù„Ù "${fileName}" Ø¨Ù†Ø¬Ø§Ø­.`;
            status.style.color = 'green';
          } else {
            const err = await res.json();
            status.innerText = `âŒ ÙØ´Ù„ Ø§Ù„Ø±ÙØ¹: ${err.message}`;
            status.style.color = 'red';
          }
        } catch (err) {
          status.innerText = 'âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù€ GitHub.';
          status.style.color = 'red';
        }
      };

      reader.readAsBinaryString(file);
    }
  </script>
</body>
</html>
